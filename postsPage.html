<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pradhaan Blogs: Voice of the People for Local Leadership</title>
  <link rel="canonical" href="https://pradhaan.in/blog-details.html" />
  <meta name="robots" content="index, follow" />
  <meta name="description"
    content="Join the Pradhaan revolution. Break the silence, speak up for your community,encourage local leaders. Empowerment, leadership, and democracy in action with Pradhaan." />
  <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Pradhaan",
        "url": "https://pradhaan.in/",
        "logo": "https://pradhaan.in/assets/images/new%20logo%20(2).jpg"
      }
    </script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RLJMEYDWHZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "G-RLJMEYDWHZ");
  </script>
  <meta property="og:title" content="Pradhaan" />
  <meta property="og:description" content="Your Place. Your Voice. Your Leadership." />
  <meta property="og:image" content="https://pradhaan.in/assets/images/new%20logo%20(2).jpg" />
  <meta property="og:url" content="pradhaan.in" />
  <meta name="og:site_name" content="Pradhaan.in" />
  <title>Pradhaan</title>
  <!-- favicon -->
  <link rel="IMG-20231205-WA0027" sizes="180x180" href="assets/images/favicons/IMG-20231205-WA0027.jpg" />
  <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicons/logo4.jpg" />
  <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicons/logo3.jpg" />
  <link rel="manifest" href="assets/images/favicons/site.webmanifest" />
  <!-- plugin scripts -->
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/animate.min.css" />
  <link rel="stylesheet" href="assets/css/bootstrap-select.min.css" />
  <link rel="stylesheet" href="assets/css/bootstrap-datepicker.min.css" />
  <link rel="stylesheet" href="assets/css/fontawesome-all.min.css" />
  <link rel="stylesheet" href="assets/css/magnific-popup.css" />
  <link rel="stylesheet" href="assets/css/owl.carousel.min.css" />
  <link rel="stylesheet" href="assets/css/owl.theme.default.min.css" />
  <link rel="stylesheet" href="assets/css/apton-icons.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />

  <!-- theme styles -->
  <link rel="stylesheet" href="assets/css/style.css" />
  <link rel="stylesheet" href="assets/css/responsive.css" />



</head>

<body>
  <div class="preloader">
    <img src="assets/images/IMG-20231205-WA0027.jpg" width="75" class="preloader__image" alt="Pradhaan Blog" />
  </div>
  <!-- /.preloader -->

  <div class="page-wrapper">
    <header class="site-header-one stricky site-header-one__fixed-top">
      <div class="container-fluid">
        <a href="/">
          <div class="site-header-one__logo">
            <div class="logo-size">
              <img src="assets/images/new_logo_(2).png" alt="logo" style="height: 8vh; object-fit: cover" />
            </div>
          </div>
        </a>

        <!-- /.site-header-one__logo -->
        <div class="main-nav__main-navigation">
          <ul class="main-nav__navigation-box one-page-scroll-menu">
            <li class="scrollToLink">
              <a href="/">Home</a>
            </li>
            <li class="scrollToLink">
              <a href="pradhaantoday.html">Pradhaan Today</a>
            </li>
            <li class="scrollToLink">
              <a href="voting.html">Voting</a>
            </li>
            <li class="scrollToLink">
              <a href="pradhaanpledge.html">Pledge</a>
            </li>
            <li class="scrollToLink">
              <a href="neuro.html">Neuro</a>
            </li>
            <li class="scrollToLink">
              <a href="Mission.html"> Mission</a>
            </li>
            <li class="scrollToLink">
              <a href="blog-details.html">Blog</a>
            </li>
            <li class="scrollToLink">
              <a href="G20.html">G20</a>
            </li>
            <li class="scrollToLink">
              <a href="sponsor.html">Sponsors</a>
            </li>
          </ul>
          <!-- /.main-nav__navigation-box -->
        </div>
        <!-- /.main-nav__main-navigation -->

        <div class="main-nav__right">
          <a href="https://play.google.com/store/apps/details?id=com.ioninks.pradhaan&pli=1"
            class="thm-btn main-nav__btn-two" target="_blank" rel="noopener noreferrer">
            <span>Download App</span>
          </a>
        </div>
        <div class="menu__toggler_header">
          <span class="side-menu__toggler"><i class="fa fa-bars"></i></span>
        </div>

        <!-- <div style="margin-left: 20px" id="auth-container">
            <button id="login-button">Login</button>
            <button id="logout-button" style="display: none">Logout</button>
            <div id="user-info"></div>
          </div> -->

        <!-- /.main-nav__right -->
      </div>
      <!-- /.container-fluid -->
    </header>
    <!-- /.site-header-one -->



    <div style=" margin-top: 120px;" id="posts-container"></div>
    <button id="load-more-button" style="display:none;">Load More</button>

    <script type="module">
      // Import Firebase modules
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
      import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
      import {
        collection,
        doc,
        getDocs,
        getDoc,
        setDoc,
        getFirestore,
        deleteDoc,
        onSnapshot,
        updateDoc,
        arrayUnion,
        arrayRemove,
        serverTimestamp,
        query,
        where,
        increment,
        addDoc,
        limit,
        startAfter
      } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyCN2Q-jQqFJUzpHohPD16CJV4LwKg6nvf8",
        authDomain: "chunaw-a66df.firebaseapp.com",
        projectId: "chunaw-a66df",
        storageBucket: "chunaw-a66df.appspot.com",
        messagingSenderId: "379389559599",
        appId: "1:379389559599:web:e3788d2d8872cf629d17da",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const firestore = getFirestore(app);
      const auth = getAuth(app);

      let currentUser = null;

      onAuthStateChanged(auth, (user) => {
        if (user) {
          currentUser = user;
          console.log(currentUser, "currentUser");
        } else {
          console.log("No user is signed in");
        }
        // Fetch posts after auth state changes
        fetchPosts();
      });

      let lastVisible = null; // Keep track of the last visible document
      const postsPerPage = 5; // Number of posts to load per page


      async function fetchPosts(loadMore = false) {
        const postsContainer = document.getElementById("posts-container");

        let postsQuery = query(
          collection(firestore, "posts"),
          where("post_image", "!=", ""), // Ignoring posts with empty post_image
          limit(postsPerPage)
        );

        if (loadMore && lastVisible) {
          postsQuery = query(postsQuery, startAfter(lastVisible));
        }

        const postsSnapshot = await getDocs(postsQuery);

        if (!loadMore) {
          postsContainer.innerHTML = ""; // Clear container if not loading more
        }

        postsSnapshot.forEach((doc) => {
          const postData = doc.data();
          const postId = doc.id;

          const postDiv = document.createElement("div");
          postDiv.classList.add("post");

          // Post image
          const postImage = document.createElement("img");
          postImage.src = postData.post_image;
          postImage.alt = "Post Image";
          postImage.classList.add("post-image");
          postDiv.appendChild(postImage);

          // Post description
          const postDesc = document.createElement("p");
          postDesc.innerText = postData.post_desc;
          postDesc.classList.add("post-desc");
          postDiv.appendChild(postDesc);

          // Like and Comment section
          const likeCommentSection = document.createElement("div");
          likeCommentSection.classList.add("like-comment-section");

          // Like button
          const likeButton = document.createElement("button");
          likeButton.classList.add("like-button");
          likeButton.innerText = `Like (${postData.like_count})`;
          likeButton.addEventListener("click", () => handleLike(postId));
          likeCommentSection.appendChild(likeButton);

          // Comment section
          const commentSection = document.createElement("div");
          commentSection.classList.add("comment-section");

          // Comment input
          const commentInput = document.createElement("textarea");
          commentInput.placeholder = "Add a comment...";
          commentSection.appendChild(commentInput);

          // Post comment button
          const postCommentButton = document.createElement("button");
          postCommentButton.classList.add("post-comment-button");
          postCommentButton.innerText = "Post Comment";
          postCommentButton.addEventListener("click", () => handleComment(postId, commentInput.value));
          commentSection.appendChild(postCommentButton);

          // Append the like and comment section to the post
          likeCommentSection.appendChild(commentSection);
          postDiv.appendChild(likeCommentSection);

          // Append the postDiv to the container
          postsContainer.appendChild(postDiv);

          // Fetch and display comments
          fetchAndDisplayComments(postId, commentSection);
        });

        // Update the lastVisible document for the next page
        lastVisible = postsSnapshot.docs[postsSnapshot.docs.length - 1];

        // Show or hide the "Load More" button
        const loadMoreButton = document.getElementById("load-more-button");
        if (postsSnapshot.size < postsPerPage) {
          loadMoreButton.style.display = "none"; // Hide if no more posts
        } else {
          loadMoreButton.style.display = "block"; // Show if there are more posts
        }
      }

      // Function to handle like functionality
      async function handleLike(postId) {
        if (!currentUser) {
          alert("Please log in to like the post.");
          return;
        }
        try {
          const postRef = doc(firestore, "posts", postId);
          const likesCollection = collection(postRef, "like"); // Use "like" if that's your subcollection name
          // Check if the user has already liked the post
          const q = query(likesCollection, where("user_id", "==", currentUser.uid));
          const querySnapshot = await getDocs(q);
          if (querySnapshot.empty) {
            // Add a new like
            await addDoc(likesCollection, {
              post_id: postId,
              user_id: currentUser.uid,
              createdAt: serverTimestamp()
            });

            // Update the like count in the post document
            await updateDoc(postRef, {
              like_count: increment(1)
            });

            alert("Post liked!");
          } else {
            // User has already liked the post, optionally allow unliking
            const likeDoc = querySnapshot.docs[0];
            await deleteDoc(likeDoc.ref);

            // Update the like count in the post document
            await updateDoc(postRef, {
              like_count: increment(-1)
            });

            alert("Like removed!");
          }
        } catch (error) {
          console.error("Error liking/unliking post: ", error);
        }
      }

      // Function to handle comment functionality
      async function handleComment(postId, commentText) {
        if (!currentUser) {
          alert("Please log in to comment on the post.");
          return;
        }
        try {
          const postRef = doc(firestore, "posts", postId);
          const commentsCollection = collection(postRef, "comment"); // Use "comment" if that's your subcollection name
          await addDoc(commentsCollection, {
            post_id: postId,
            user_id: currentUser.uid,
            createdAt: serverTimestamp(),
            comment: commentText
          });

          // Update the comments count in the post document
          await updateDoc(postRef, {
            comments_count: increment(1)
          });

          alert("Comment posted!");
        } catch (error) {
          console.error("Error posting comment: ", error);
        }
      }

      // Function to fetch and display comments
      async function fetchAndDisplayComments(postId, commentSection) {
        const commentsCollection = collection(firestore, "posts", postId, "comment");

        onSnapshot(commentsCollection, (commentsSnapshot) => {
          commentSection.innerHTML = ""; // Clear existing comments

          // Recreate comment input and button
          const commentInput = document.createElement("textarea");
          commentInput.placeholder = "Add a comment...";
          commentInput.rows = 2;
          commentInput.cols = 50;
          commentSection.appendChild(commentInput);

          const postCommentButton = document.createElement("button");
          postCommentButton.classList.add("post-comment-button");
          postCommentButton.innerText = "Post Comment";
          postCommentButton.addEventListener("click", () => {
            const commentText = commentInput.value.trim();
            if (commentText !== "") {
              handleComment(postId, commentText);
              commentInput.value = ""; // Clear the input after posting
            } else {
              alert("Comment cannot be empty.");
            }
          });
          commentSection.appendChild(postCommentButton);

          commentsSnapshot.forEach((doc) => {
            const commentData = doc.data();
            const commentDiv = document.createElement("div");
            commentDiv.classList.add("comment");
            commentDiv.innerText = commentData.comment;
            commentSection.appendChild(commentDiv);
          });
        });
      }


      // Add a "Load More" button event listener
      document.getElementById("load-more-button").addEventListener("click", () => {
        fetchPosts(true); // Fetch the next set of posts
      });

      // Call the function to fetch the initial posts
      fetchPosts();
    </script>





  </div>
  <!-- /.page-wrapper -->
  <a href="#" data-target="html" class="scroll-to-target scroll-to-top"><i class="fa fa-angle-up"></i></a>
  <div class="side-menu__block">
    <div class="side-menu__block-overlay custom-cursor__overlay">
      <div class="cursor"></div>
      <div class="cursor-follower"></div>
    </div>
    <!-- /.side-menu__block-overlay -->
    <div class="side-menu__block-inner">
      <div class="side-menu__top justify-content-end">
        <a href="#" class="side-menu__toggler side-menu__close-btn"><img src="assets/images/shapes/close-1-1.png"
            alt="Empowering Local Leadership" /></a>
      </div>
      <!-- /.side-menu__top -->

      <nav class="mobile-nav__container">
        <!-- content is loading via js -->
      </nav>
      <div class="side-menu__sep"></div>
      <!-- /.side-menu__sep -->
      <div class="side-menu__content">
        <div class="main-nav__right">
          <!-- <a
                                          href="https://play.google.com/store/apps/details?id=com.ioninks.pradhaan&pli=1"
                                          class="thm-btn main-nav__btn-two"
                                          target="_blank"
                                          rel="noopener noreferrer"
                                    >
                                          <span>Download App</span>
                                    </a> -->
        </div>
        <!--<p><a href="mailto:needhelp@apton.com">needhelp@apton.com</a> <br> <a href="tel:888-999-0000">888 999-->
        <!--        0000</a></p>-->
        <div class="side-menu__social">
          <a target="_blank" href="https://www.facebook.com/people/Pradhaan-India/61556919577490/?mibextid=ZbWKwL"><i
              class="fa-brands fa-square-facebook"></i></a>

          <a target="_blank" href="https://x.com/PradhaanIndia?t=qjUaPfV2pXryeFyK1C4__w&amp;s=09"><i
              class="fa-brands fa-square-twitter"></i></a>

          <a target="_blank"
            href="https://www.instagram.com/pradhaanindia/?utm_source=qr&amp;igsh=MXIxbWZ3MnhmdTV1Zw%3D%3D"><i
              class="fa-brands fa-square-instagram"></i></a>

          <a target="_blank" href="https://www.pinterest.com/pradhaanindia/"><i
              class="fa-brands fa-square-pinterest"></i></a>
        </div>
      </div>
      <!-- /.side-menu__content -->
    </div>
    <!-- /.side-menu__block-inner -->
  </div>
  <!-- /.side-menu__block -->

  <script src="assets/js/jquery-3.5.0.min.js"></script>
  <script src="assets/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/bootstrap-select.min.js"></script>
  <script src="assets/js/bootstrap-datepicker.min.js"></script>
  <script src="assets/js/isotope.js"></script>
  <script src="assets/js/jquery.ajaxchimp.min.js"></script>
  <script src="assets/js/jquery.waypoints.min.js"></script>
  <script src="assets/js/jquery.counterup.min.js"></script>
  <script src="assets/js/jquery.magnific-popup.min.js"></script>
  <script src="assets/js/jquery.validate.min.js"></script>
  <script src="assets/js/owl.carousel.min.js"></script>
  <script src="assets/js/TweenMax.min.js"></script>
  <script src="assets/js/wow.js"></script>
  <script src="assets/js/theme.js"></script>
</body>

</html>